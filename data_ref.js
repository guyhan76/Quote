window.REF_SHEETS = [
  {key:'용지가격참조', title:'용지가격참조'},
  {key:'원단가격참조', title:'원단가격참조'},
  {key:'옵셋인쇄비참조', title:'옵셋인쇄비참조'},
  {key:'코팅비참조', title:'코팅비참조'},
  {key:'운송비참조', title:'운송비참조'},
];

window.REF_SAMPLE = {
  '용지가격참조': {
    head:['지종','평량(gsm)','고시가kg','구분','재단','생산','비고'],
    rows:[
      ['SC',220,1542,'kg단가',1000,870,'특수물량 협의'],
      ['', '', '', '할인율',0.35,0.43,''],
      ['SC',240,1493,'kg단가',1073,925,''],
      ['', '', '', '할인율',0.28,0.38,''],
    ]
  },

  '원단가격참조': {
    head:['구분','골','지종','…','원지가격(수식)','…'],
    rows:[
      [1,'A','K180','', 'VLOOKUP(C5,R4:U64,4,false)',''],
      [3,'A','K180','', 'VLOOKUP(C6,R4:U64,4,false)',''],
    ]
  },

  '옵셋인쇄비참조': {
    head:['수량R','대국전','하드롱','특하드롱','구분','도수적용','비고'],
    rows:[
      [1,20000,25000,'=C2+5000','기본도수','3도','3도이내'],
      [2,15000,18000,25000,'기본가격',100000,'4원색'],
    ]
  },

  '코팅비참조': {
    head:['구분','적용','단가','기본가격','비고'],
    rows:[
      ['CR','1m2',49,16000,'최대규격 1440×1000'],
      ['유광라미','1m2',120,30000,'최대규격 1430×1100'],
    ]
  },

  // 실제 운송비표(만원 단위: 4.5 => 45,000원)
  '운송비참조': (function(){
    const head = ['지역','하차지','다마스','라보','1톤','1.4톤','2.5톤','3.5톤','3.5톤 광폭','5톤','5톤플','11톤'];

    const base = [
      {region:'서울', drops:'강서구/양천', vals:[4.5,5,6,7,10,11,12,13,15,18]},
      {region:'서울', drops:'영등포/금천/구로/마포/서대문', vals:[5,6,6.5,8,11,13,14,14,16,19]},
      {region:'서울', drops:'관악구/용산/동작', vals:[5,6,7,8,12,13,15,16,18,21]},
      {region:'서울', drops:'동대문구/중구/종로', vals:[6,7,8,9,13,14,16,16,18,20]},
      {region:'서울', drops:'강남구/서초/일월/세곡/내곡', vals:[6,7,8,9,13,14,16,17,18,20]},
      {region:'서울', drops:'수서/송파/성동/강동/광진', vals:[6,7,8,9,13,14,16,17,18,21]},
      {region:'서울', drops:'강북/노원/도봉/면목', vals:[6,7,8,9,12,13,15,16,18,20]},
      {region:'서울', drops:'중랑/신내/망우', vals:[6,7,8,9,13,13,15,16,18,21]},

      {region:'인천', drops:'당하동/서부공단', vals:[3,3.5,4,5,7,8,9,10,12,15]},
      {region:'인천', drops:'계산/박촌', vals:[3.5,4,5,6,8,9,10,11,13,16]},
      {region:'인천', drops:'가좌/석남/도화/십정', vals:[4,4.5,5.5,6.5,8,9,10,12,14,16]},
      {region:'인천', drops:'동인천/월미도/터미널', vals:[4,5,5.5,6,8,9,10,12,14,16]},
      {region:'인천', drops:'남동공단/연안부두/송도', vals:[4.5,5,6,7,9,10,11,13,14,16]},
      {region:'인천', drops:'인천공항/영종도', vals:[5,6,7,8,10,11,12,14,16,18]},

      {region:'경기도', drops:'김포 관내/학운리', vals:[3,3.5,4,5,6,7,8,9,10,13]},
      {region:'경기도', drops:'고촌/풍무/운양/장기', vals:[3.5,4,5,6,7,8,9,10,11,15]},
      {region:'경기도', drops:'부천/송내', vals:[4,4.5,5,6,9,10,11,12,13,16]},
      {region:'경기도', drops:'광명/시흥/시화/반월/안양', vals:[5.5,6,7,8,10,11,12,13,15,19]},
      {region:'경기도', drops:'군포/안산', vals:[5.5,6.5,8,9,11,12,13,14,16,20]},
      {region:'경기도', drops:'일산/고양', vals:[4,4.5,5,6,8,9,10,11,13,16]},
      {region:'경기도', drops:'파주/월릉/문산/광탄/탄현', vals:[5,5.5,6,7,10,11,12,13,14,18]},
      {region:'경기도', drops:'임진각/적성/법원리', vals:[6,7,8,9.5,12,13,14,15,16,20]},
      {region:'경기도', drops:'비봉/수원/성남/하남/판교', vals:[7,8,9,10,13,14,16,17,19,22]},
      {region:'경기도', drops:'발안/화성/동탄/오산', vals:[7.5,8.5,9.5,11,13,14,15,17,19,23]},
      {region:'경기도', drops:'광주/마석/오포/곤지암', vals:[7,8,9,10,14,15,16,18,20,22]},
      {region:'경기도', drops:'용인/양지', vals:[8,9,10,11,15,16,17,18,20,23]},
      {region:'경기도', drops:'의정부/퇴계원/구리', vals:[6.5,7,7.5,9,12,13,14,16,17,20]},
      {region:'경기도', drops:'광적/양주/남양주/별내/진접', vals:[7,8,9,10,12,13,14,16,18,21]},
      {region:'경기도', drops:'수동/동두천/내촌/화도', vals:[7,7.5,8.5,9.5,13,14,15,17,18,21]},
      {region:'경기도', drops:'포천/일동/창수/영중', vals:[7.5,8.5,9.5,11,14,15,16,18,19,23]},
      {region:'경기도', drops:'이천/덕평/백암', vals:[8,9,11,12,14,16,18,19,21,23]},
      {region:'경기도', drops:'여주/장호원', vals:[9,10,11,13,15,16,18,20,22,25]},
      {region:'경기도', drops:'가평/양평/용문/강촌/청평', vals:[9,10,12,13,15,16,17,19,21,24]},
      {region:'경기도', drops:'강촌/청평', vals:[10,12,14,15,18,19,20,22,23,30]},
      {region:'경기도', drops:'평택/송탄/안성', vals:[9,10,11,13,15,16,17,20,21,24]},

      {region:'강원도', drops:'철원/춘천', vals:[9,11,12,14,17,19,20,21,22,28]},
      {region:'강원도', drops:'횡성/새말/홍천', vals:[10,12,16,17,20,21,22,25,27,32]},
      {region:'강원도', drops:'문막/원주', vals:[11,13,14,15,19,20,21,23,25,31]},
      {region:'강원도', drops:'화천/평창/용평', vals:[14,16,20,22,27,28,29,32,34,38]},
      {region:'강원도', drops:'강릉/주문/속초/양양', vals:[16,18,22,25,30,32,33,34,36,43]},
      {region:'강원도', drops:'태백/정선/영월', vals:[16,18,22,24,31,32,33,34,36,43]},
      {region:'강원도', drops:'동해/삼척', vals:[17,19,23,24,32,34,35,36,39,47]},

      {region:'세종', drops:'연기/조치원', vals:[11,12,13,15,19,20,21,23,24,29]},
      {region:'대전', drops:'대덕/동/중/서/유성', vals:[11,12,15,16,20,22,23,25,27,32]},

      {region:'충남', drops:'서산/예산', vals:[10,11,13,15,18,19,20,21,22,27]},
      {region:'충남', drops:'공주/보령/태안/안면도/청양/홍성', vals:[12,13,15,16,20,22,24,25,27,30]},
      {region:'충남', drops:'금산/계룡/논산/부여/서천', vals:[12,13,16,17,21,23,24,27,29,34]},
      {region:'충남', drops:'대천/당진/성환/아산/천안', vals:[9,10,12,14,17,18,19,21,22,26]},

      {region:'충북', drops:'괴산/음성/진천/증평/충주', vals:[10,11,13,15,18,19,20,22,23,28]},
      {region:'충북', drops:'보은/청원/청주/제천', vals:[12,13,15,16,20,22,23,25,26,31]},
      {region:'충북', drops:'단양/옥천/영동', vals:[13,14,16,18,22,25,26,28,29,36]},

      {region:'전남', drops:'곡성/구례/담양/영광/함평', vals:[17,19,24,26,29,31,32,36,37,45]},
      {region:'전남', drops:'광양/나주/무안/목포/순천/화순', vals:[20,21,26,28,33,35,36,38,39,51]},
      {region:'전남', drops:'고흥/강진/보성/영암/진도/장흥/해남', vals:[21,23,29,30,35,37,38,43,45,54]},

      {region:'전북', drops:'군산/김제/완주/익산/전주', vals:[13,14,17,19,24,25,26,29,31,37]},
      {region:'전북', drops:'무주/부안/정읍/임실/진안', vals:[14,15,18,20,26,28,29,32,34,39]},
      {region:'전북', drops:'고창/남원/순창/장수', vals:[14,15,22,23,30,32,33,35,37,44]},

      {region:'대구', drops:'군위', vals:[15,16,20,21,28,29,30,34,36,44]},

      {region:'경남', drops:'거창/함양/산청/합천/창녕', vals:[19,20,22,24,30,32,34,37,39,48]},
      {region:'경남', drops:'마산/밀양/진주/하동', vals:[20,21,23,25,31,33,35,38,40,51]},
      {region:'경남', drops:'김해/양산/창원/진해', vals:[21,22,26,28,33,35,36,39,42,53]},
      {region:'경남', drops:'거제/부산/사천/통영', vals:[21,23,26,29,35,37,39,41,43,56]},

      {region:'경북', drops:'김천/문경/상주/영주/예천/안동', vals:[15,16,20,21,27,29,30,33,35,41]},
      {region:'경북', drops:'고령/구미/성주/의성/울진/청송/칠곡', vals:[17,18,21,23,28,31,32,35,37,44]},
      {region:'경북', drops:'경산/경주/영덕/영양/영천/청도/포항', vals:[20,21,23,25,31,33,35,38,40,48]},

      {region:'울산', drops:'울주/언양', vals:[20,21,25,27,32,34,36,39,41,52]},
    ];

    const rows = [];
    const seen = new Set();

    function addRow(region, drop, vals){
      const key = region + '|' + drop;
      if(seen.has(key)) return;
      seen.add(key);
      rows.push([region, drop, ...vals]);
    }

    for(const b of base){
      const region = String(b.region||'').trim();
      const parts = String(b.drops||'')
        .split('/')
        .map(x=>String(x).trim())
        .filter(Boolean);

      for(const p of parts){
        addRow(region, p, b.vals);
        if(p.endsWith('구') && p.length >= 2) addRow(region, p.slice(0, -1), b.vals);
        if(region === '서울' && p === '중랑') addRow(region, '중랑구', b.vals);
      }
    }

    return { head, rows };
  })()
};
